# ==========  ベースイメージ設定  ==========
# Node.js 18をベースにする（Alpine Linuxで軽量）
FROM node:18-alpine

# ==========  作業ディレクトリ設定  ==========
# コンテナ内での作業フォルダを指定
WORKDIR /app

# ==========  パッケージファイルをコピー  ==========
# package.jsonとpackage-lock.jsonを先にコピー
# （依存関係の変更がない限り、この層はキャッシュされる）
COPY package*.json ./

# ==========  依存関係インストール  ==========
# npm install を実行
RUN npm install

# ==========  ソースコードをコピー  ==========
# 残りのファイルをすべてコピー
COPY . .

# ==========  ポート公開  ==========
# Nuxt.jsのデフォルトポート3000を公開
EXPOSE 3000

# ==========  開発サーバー起動  ==========
# コンテナ起動時に実行するコマンド
CMD ["npm", "run", "dev"]